\chapter{A model for methane hydrates}
\label{ch:models}
Having the theoretical framework of molecular dynamics in place, it is time to introduce specific potentials, and choose which one to use for investigating cracks in methane hydrates. 

In this chapter, I describe moelcular potentials for water and methane, and choose which one to use in my simulations.  

\section{Criteria for a sufficient model}
I will model dissociation of methane hydrates. As long as the methane hydrates are pure, i.e. no sediments nearby, it is reasonable to assume that noe chemical reactions will take place @cite. Therefore a TIP-model @WhatDoesTipMean should be sufficient. Since I will model fracture, the mechanical properties should be reasonably represented. Since I lack experience with water models, I end up using a model that other people have shown to work. Specifically, I choose a model that was able to spontaneously nucleate methane hydrates in molecular dynamics simulations. 

\section{TIP4P/ICE water model}
The TIP4P/ICE was developed by \citet{Abascal2005} as a reparametrization of the TIP4P water model. TIP4P was used by \citet{Matsumoto2002} in the first successfull simulations of nucleation of ice crystals in molecular dynamics, and TIP4P/ICE was used by \citet{Walsh2009} in the first successful simulation of spontaneous methane hydrate nucleation. 

\subsection{Overview}
The TIP4P-ICE water model is a rigid wnrkater model with 4 sites for each water molecule: One O-site, two H-sites, and a site commonly referred to as the M-site. The M-site is supposed to slightly move the oxygen charge, and it is situated on the bisector of the H-O-H angle. The parameters for the arrangement as well as the masses of hydrogen and oxygen are taken from experimental observations, and were listed in table \ref{tb:intro:h2odata}.

\begin{table}[h!tb]
\caption{Parameters for TIP4P-ICE model as in \cite{Abascal2005}.}
\begin{center}
\begin{tabular}{c|c|c}
Description & Symbol & Value \\ 
\hline
Lennard-Jones energy & $\varepsilon/k$ & \SI{100.5}{\kelvin} \\
Lennard-Jones characteristic distance & $\sigma_{OO}$ & \SI{3.155}{\angstrom} \\
Distance O-site to M-site along bisector & $d_{OM}$ & \SI{0.157}{\angstrom} \\
Hydrogen charge & $q_H$ & \SI{0.5676}{\elementarycharge} \\
\end{tabular}
\end{center}
\end{table}

\subsection{Interactions}
There are two interaction potentials for TIP4P-ICE: electrostatic interactions and Lennard-Jones (LJ) interactions, with the following functional forms:

\begin{align}
	U_{LJ} & = 4\varepsilon\left[\left(\frac{\sigma}{r_{OO}}\right)^{12} - \left(\frac{\sigma}{r_{OO}}\right)^{6}\right]
	\label{eq:part1:lennardjonespotential}
	\\
	U_{\si{\elementarycharge}} & = \frac{\si{\elementarycharge\squared}}{4\pi\varepsilon_0} \sum_{a, b} \frac{q_aq_b}{r_{ab}}
	\label{eq:part1:electrostaticpotential}
\end{align}

Since the molecules are treated as rigid, interactions are only between sites on different molecules. 

\subsection{Parameters for the TIP4P family}
TIP4P is a family of potentials, of which TIP4P/ICE is one member. The TIP4P potentials differ only in the values of their parameters. TIP4P/ICE has not been thoroughly investigated, and therefore, several simple properties such as the shear viscosity are unknown. To be able to verify my use of the TIP4P/ICE, i will do simulations with parameters from other TIP4P models for verification, and then I will work out properties for the TIP4P model. For this I need parametes for additional members of the TIP4P family. I these parameters in table \ref{tbl:tip4p_parameters}.

\begin{table}
\caption{Parameters for the different parametrizations in the TIP4P family.}
\label{tbl:tip4p_parameters}
\begin{tabular}{c|c|c|c}
Description & Symbol & TIP4P & TIP4P/2005 \\ 
\hline
Lennard-Jones energy & $\varepsilon/k$ & \SI{78.0}{\kelvin} & \SI{93.2}{\kelvin} \\
Lennard-Jones characteristic distance & $\sigma_{OO}$ & \SI{3.154}{\angstrom} & \SI{3.1589}{\angstrom} \\
Distance O-site to M-site along bisector & $d_{OM}$ & \SI{0.150}{\angstrom} & \SI{0.1546}{\angstrom} \\
Hydrogen charge & $q_H$ & \SI{0.520}{\elementarycharge} & \SI{0.5564}{\elementarycharge} \\
\end{tabular}
\end{table}

\section{OPLS methane}
OPLS-UA and OPLS-AA. I will choose OPLS-UA for simplicity. Another potential might be used in the future. 
United atom methane is the united atom model for methane, and is effectively a single Lennard-Jones interaction site for each methane molecule. 
\begin{equation}
	U_{LJ} = 4\varepsilon\left[\left(\frac{\sigma}{r_{MM}}\right)^{12} - \left(\frac{\sigma}{r_{MM}}\right)^{6}\right]
	\label{eq:part1:lennardjonespotentialmethane}
\end{equation}
A parameter set for this methane representation can for example be taken from \cite{Martin1998}, and are listed in \ref{tb:parameters_unitedatommethane}. 

\begin{table}
\caption{Lennard-Jones parameters for united atom methane.}
\label{tb:parameters_unitedatommethane}
\begin{center}
\begin{tabular}{c|c|c}
Description & Symbol & Value \\
\hline
Lennard-Jones energy & $\varepsilon/k_B$ & \SI{147.9}{\kelvin} \\
Lennard-Jones characteristic distance & $\sigma_{MM}$ & \SI{3.73}{\angstrom}
\end{tabular}
\end{center}
\end{table}

\section{Combining particles of different species in a model}
Having different potentials, for different aggregate particles (such as TIP4P/ICE), we want a way to combine them in a model containing both species. For electrostatic interactions, the combination rules are straightforward, as they follow from Coulombs law. For Lennard-Jones interactions, there is not such a simple combination law, and in principle, one has to fit parameters for each unique pair of particles. Luckily, it is possible to make rules that combine particles without going into an extensive parameter fitting exercise. 

\subsection{Lorentz-Berthelot combination rules}
Perhaps the simplest way to combine two species Lennard-Jones particles, is to use the following rules from two sets of parameters ($\varepsilon_{ii}$, $\sigma_{ii}$) and ($\varepsilon_{jj}$, $\sigma_{jj}$) for interactions between two particles of the same species i or j, on to a set of parameters ($\varepsilon_{ij}$, $\sigma_{ij}$) for interactions between one particle of each species:
\begin{align}
\varepsilon_{ij}Â = \sqrt{\varepsilon_{ii}\varepsilon_{jj}} \\
\sigma_{ij} = \frac{1}{2} \left(\sigma_{ii}+\sigma_{jj}\right)
\end{align}

\section{TIP4P-ICE + OPLS-UA methane}
We now have all the ingredients we need to model a methane hydrates: A water model, a methane model, and a way to make the water and the methane interact with each other. This model is essentially a description of the total energy of a system consisting of particles with known positions and momenta. The next step is to use molecular dynamics to explore the properties of this model, and to see if we can use this model to learn something about methane hydrate. 

