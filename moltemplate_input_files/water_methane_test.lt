# My first moltemplate test script for simulating water and methane with parameters similar to walsh 2009.

# 
#	file "water_methane_test.lt"
#	
#
# 		H1		H2
#		 \		/
# 			O
#

TIP4P_ICE 
{
	write_once("In Init") 
	{
		units			real
		dimension 		3
		boundary 		p p p 
		atom_style 		full
		pair_style 		lj/cut/tip4p/cut @atom:O @atom:H @bond:OH @angle:HOH 0.1577 8.5
		bond_style 		harmonic
		angle_style		harmonic
		pair_modify		mix arithmetic # Lorenz-Berthelot mixing rules
	}

	write("Data Atoms") 	
	{
		# atomID	molID		atomType 	charge
		$atom:O 	$mol:. 		@atom:O 	-1.1794		0.0				 0.0			0.0
		$atom:H1 	$mol:. 		@atom:H 	 0.5897		0.75695033		 0.58588227		0.0
		$atom:H2 	$mol:. 		@atom:H 	 0.5897	   -0.75695033   	 0.58588227		0.0
	}

	write_once("Data Masses")
	{
		@atom:O 	15.9994
		@atom:H 	1.008
	}

	write("Data Angles")
	{
		$angle:HOH 	@angle:HOH	$atom:H1	$atom:O 	$atom:H2 
	}

	write("Data Bonds")
	{
		$bond:OH 	@bond:OH $atom:O $atom:H1
		$bond:OH 	@bond:OH $atom:O $atom:H2
	}

	write_once("In Settings")
	{
		pair_coeff 	@atom:O 	@atom:O 	0.21084 	3.1668
		pair_coeff 	@atom:H 	@atom:H		0.0 		0.0
		
		bond_coeff  @bond:OH 	0.0 		0.9572
		angle_coeff @angle:HOH	0.0 		104.52

		fix		fShake	all 	shake 	0.0001 100 0 b @bond:OH a @angle:HOH
	}
}


LJ_METHANE
{
	write("Data Atoms")
	{
		$atom:CH4	$mol:. 	@atom:CH4 	0.0 	0.0 	0.0 	0.0 	
	}

	write_once("Data Masses")
	{
		@atom:CH4 	16.04 	
	}

	write_once("In Settings")
	{
		pair_coeff @atom:CH4 	@atom:CH4 	 0.29391 	3.73
	}
}


wat = new TIP4P_ICE	[10].move(0, 0, 3.45)
					[10].move(0, 3.45, 0)
					[8].move(3.45, 0, 0)

met = new LJ_METHANE 	[10].move(0, 0, 3.45)
						[10].move(0, 3.45, 0)
						[3].move(3.45, 0, 0)

met[*][*][*].move(27.6, 0, 0)

write_once("Data Boundary")
{
	0.0 37.95 xlo xhi
	0.0 34.5 ylo yhi
	0.0 34.5 zlo zhi
}